<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1"><!-- Begin Jekyll SEO tag v2.8.0 -->
<title>æ„å»º Chromiumï¼ˆå¢™å†…ï¼‰ | PwnTips</title>
<meta name="generator" content="Jekyll v4.2.2" />
<meta property="og:title" content="æ„å»º Chromiumï¼ˆå¢™å†…ï¼‰" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="æœ¬æ–‡è®°å½•åœ¨ Windows ç³»ç»Ÿæ„å»º Chromium çš„è¿‡ç¨‹ï¼Œæ–¹æ³•å®Œå…¨æŠ„è¢­è‡ª å®˜æ–¹æ–‡æ¡£ï¼Œä»…åŠ å…¥ä¸€äº›ä»£ç†é…ç½®ç›¸å…³çš„å†…å®¹ã€‚" />
<meta property="og:description" content="æœ¬æ–‡è®°å½•åœ¨ Windows ç³»ç»Ÿæ„å»º Chromium çš„è¿‡ç¨‹ï¼Œæ–¹æ³•å®Œå…¨æŠ„è¢­è‡ª å®˜æ–¹æ–‡æ¡£ï¼Œä»…åŠ å…¥ä¸€äº›ä»£ç†é…ç½®ç›¸å…³çš„å†…å®¹ã€‚" />
<link rel="canonical" href="https://pwntips.github.io/2022/03/20/build-chromium.html" />
<meta property="og:url" content="https://pwntips.github.io/2022/03/20/build-chromium.html" />
<meta property="og:site_name" content="PwnTips" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2022-03-20T00:00:00+08:00" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="æ„å»º Chromiumï¼ˆå¢™å†…ï¼‰" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2022-03-20T00:00:00+08:00","datePublished":"2022-03-20T00:00:00+08:00","description":"æœ¬æ–‡è®°å½•åœ¨ Windows ç³»ç»Ÿæ„å»º Chromium çš„è¿‡ç¨‹ï¼Œæ–¹æ³•å®Œå…¨æŠ„è¢­è‡ª å®˜æ–¹æ–‡æ¡£ï¼Œä»…åŠ å…¥ä¸€äº›ä»£ç†é…ç½®ç›¸å…³çš„å†…å®¹ã€‚","headline":"æ„å»º Chromiumï¼ˆå¢™å†…ï¼‰","mainEntityOfPage":{"@type":"WebPage","@id":"https://pwntips.github.io/2022/03/20/build-chromium.html"},"url":"https://pwntips.github.io/2022/03/20/build-chromium.html"}</script>
<!-- End Jekyll SEO tag -->
<link rel="stylesheet" href="/assets/css/style.css"><link type="application/atom+xml" rel="alternate" href="https://pwntips.github.io/feed.xml" title="PwnTips" /><script async src="https://www.googletagmanager.com/gtag/js?id=G-LDS6Z1TT65"></script>
<script>
  window['ga-disable-G-LDS6Z1TT65'] = window.doNotTrack === "1" || navigator.doNotTrack === "1" || navigator.doNotTrack === "yes" || navigator.msDoNotTrack === "1";
  window.dataLayer = window.dataLayer || [];
  function gtag(){window.dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-LDS6Z1TT65');
</script>

</head>
<body><header class="site-header">

  <div class="wrapper"><a class="site-title" rel="author" href="/">PwnTips</a><nav class="site-nav">
        <input type="checkbox" id="nav-trigger" class="nav-trigger" />
        <label for="nav-trigger">
          <span class="menu-icon">
            <svg viewBox="0 0 18 15" width="18px" height="15px">
              <path d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.032C17.335,0,18,0.665,18,1.484L18,1.484z M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.032C17.335,6.031,18,6.696,18,7.516L18,7.516z M18,13.516C18,14.335,17.335,15,16.516,15H1.484 C0.665,15,0,14.335,0,13.516l0,0c0-0.82,0.665-1.483,1.484-1.483h15.032C17.335,12.031,18,12.695,18,13.516L18,13.516z"/>
            </svg>
          </span>
        </label>

        <div class="trigger"><a class="page-link" href="/about/">About</a></div>
      </nav></div>
</header>
<main class="page-content" aria-label="Content">
      <div class="wrapper">
        <article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">

  <header class="post-header">
    <h1 class="post-title p-name" itemprop="name headline">æ„å»º Chromiumï¼ˆå¢™å†…ï¼‰</h1>
    <p class="post-meta"><time class="dt-published" datetime="2022-03-20T00:00:00+08:00" itemprop="datePublished">
        Mar 20, 2022
      </time></p>
  </header>

  <div class="post-content e-content" itemprop="articleBody">
    <p>æœ¬æ–‡è®°å½•åœ¨ Windows ç³»ç»Ÿæ„å»º Chromium çš„è¿‡ç¨‹ï¼Œæ–¹æ³•å®Œå…¨æŠ„è¢­è‡ª <a href="https://chromium.googlesource.com/chromium/src/+/HEAD/docs/windows_build_instructions.md">å®˜æ–¹æ–‡æ¡£</a>ï¼Œä»…åŠ å…¥ä¸€äº›ä»£ç†é…ç½®ç›¸å…³çš„å†…å®¹ã€‚</p>

<h2 id="è‡´è°¢">è‡´è°¢</h2>

<p>å¤šè°¢ GFWï¼ŒæŠŠç®€å•çš„äº‹æƒ…å˜å¾—å¤æ‚ï¼Œè®©æˆ‘ä»¬äººç”Ÿå¤šäº†ä¸€äº›å†ç»ƒçš„æœºä¼šğŸ™ƒã€‚</p>

<h2 id="visual-studio">Visual Studio</h2>

<ul>
  <li>è‡³å°‘éœ€è¦ VS 2017ï¼Œæ¨èä½¿ç”¨ VS 2019ï¼Œæˆ‘ç”¨çš„ç‰ˆæœ¬æ˜¯ VS 2019 Version 16.11.9ã€‚</li>
  <li>éœ€è¦è£… Desktop development with C++ã€MFCã€ATL è¿™å‡ ä¸ªç»„ä»¶</li>
  <li>Windows SDK ç‰ˆæœ¬è¦é«˜äº 10.0.19041ï¼Œå¯¹äº VS 2019 æ¥è¯´é»˜è®¤å°±æ˜¯æ»¡è¶³çš„ï¼Œä¸æ”¾å¿ƒçš„è¯æ„å»ºå‰å¯ä»¥å…ˆæ›´æ–°ä¸‹ã€‚</li>
  <li>å¦‚æœæ˜¯ç¼–è¯‘ 2019 å¹´å·¦å³çš„æ—§ç‰ˆæœ¬ï¼Œé¦–é€‰ VS 2017ï¼Œæˆ‘åœ¨ç”¨ VS 2019 ç¼–è¯‘æ—§ç‰ˆæœ¬æ—¶é‡åˆ°äº†å…¼å®¹é—®é¢˜ï¼Œå¯ä»¥å®‰è£…å¤šä¸ªç‰ˆæœ¬ï¼Œæ„å»ºæ—¶æ˜¾ç¤ºæŒ‡å®šä½¿ç”¨çš„ç‰ˆæœ¬ã€‚</li>
</ul>

<h2 id="depot_tools">depot_tools</h2>

<p>depot_tools æ˜¯å¼€å‘ Chromium æ‰€éœ€çš„ä¸€ç³»åˆ—å·¥å…·ã€è„šæœ¬çš„é›†åˆã€‚</p>

<h3 id="å®‰è£…">å®‰è£…</h3>

<ul>
  <li>ä¸‹è½½ <a href="https://storage.googleapis.com/chrome-infra/depot_tools.zip">https://storage.googleapis.com/chrome-infra/depot_tools.zip</a>ã€‚</li>
  <li>è§£å‹åˆ°ä»»æ„ä½ç½®ï¼Œä¾‹å¦‚ d:/depot_toolsã€‚<br />
å¤šå¹´çš„é‡‡å‘ç»éªŒå‘Šè¯‰æˆ‘ï¼Œè§£å‹è·¯å¾„å±‚çº§å°‘ä¸€ç‚¹ï¼Œä¸è¦è¶…é•¿ï¼Œä¸è¦åŒ…å«ä¸­æ–‡ã€ç©ºæ ¼ï¼Œå°±ä¸å®¹æ˜“é‡åˆ°å¥‡æ€ªçš„é—®é¢˜ã€‚</li>
  <li>è§£å‹å®Œæˆåï¼Œè¦æ£€æŸ¥ä¸€ä¸‹ depot_tools ç›®å½•ï¼Œç¡®è®¤å­˜åœ¨ .git å­ç›®å½•ï¼Œå¦‚æœä¸å­˜éœ€è¦æ¢ä¸€ä¸ªè§£å‹å·¥å…·ï¼Œä¾‹å¦‚ 7zã€‚</li>
</ul>

<h3 id="é…ç½®-git-å¯é€‰">é…ç½® Git ï¼ˆå¯é€‰ï¼‰</h3>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># æäº¤ä»£ç éœ€è¦</span>
<span class="o">&gt;</span> git config <span class="nt">--global</span> user.name <span class="s2">"ReplaceWithYourUserName"</span>
<span class="o">&gt;</span> git config <span class="nt">--global</span> user.email <span class="s2">"ReplaceWithYourEmail@chromium.org"</span>
<span class="c"># git è‡ªåŠ¨è½¬æ¢æ¢è¡Œå›è½¦</span>
<span class="o">&gt;</span> git config <span class="nt">--global</span> core.autocrlf <span class="nb">false</span>
<span class="c"># git ä¸å­˜å‚¨æ–‡ä»¶æƒé™</span>
<span class="o">&gt;</span> git config <span class="nt">--global</span> core.filemode <span class="nb">false</span>
<span class="c"># ä½¿ç”¨ rebase åˆå¹¶æ‹‰å–çš„ä»£ç </span>
<span class="o">&gt;</span> git config <span class="nt">--global</span> branch.autosetuprebase always
</code></pre></div></div>

<h3 id="ç¯å¢ƒå˜é‡">ç¯å¢ƒå˜é‡</h3>

<ul>
  <li>å°† depot_tools ç›®å½•åŠ åˆ° PATHï¼Œè¦ç¡®ä¿åŠ åˆ° Python çš„å®‰è£…ç›®å½•å‰ï¼Œä¾‹å¦‚ PATH çš„ç¬¬ä¸€é¡¹ã€‚è¿™ä¼šä½¿ depot_tools ç›®å½•ä¸­çš„ Python æ›¿ä»£æœ¬åœ°å®‰è£…çš„ Pythonï¼Œå¦‚æœä½ ä¿®æ”¹çš„æ˜¯æŒä¹…åŒ–çš„ç¯å¢ƒå˜é‡é…ç½®ï¼Œç”¨å®Œåè¦æ”¹å›å»ã€‚</li>
  <li>DEPOT_TOOLS_WIN_TOOLCHAIN è®¾ç½®ä¸º 0ï¼Œä½¿ç”¨æœ¬åœ°çš„ Visual Studio å·¥å…·æ„å»º Chrome</li>
  <li>(å¯é€‰) vs2019_install/vs2017_install/vs2022_install: è®¾ç½®ä¸º Visual Studio çš„å®‰è£…ç›®å½•ã€‚
depot_tools ä¼šè‡ªåŠ¨æœç´¢ Visual Studio å®‰è£…ç›®å½•ï¼Œå¦‚æœå¯¹æœç´¢ç»“æœä¸æ»¡æ„å¯ä»¥ç”¨æ­¤ç¯å¢ƒå˜é‡æ˜¾ç¤ºæŒ‡å®šç‰ˆæœ¬å’Œå®‰è£…ç›®å½•
ä¾‹å¦‚ï¼Œæœºå™¨ä¸Šå®‰è£…äº†å¤šä¸ª Visual Studioï¼Œé»˜è®¤æœç´¢åˆ°çš„å¯èƒ½æ˜¯ VS 2019ï¼Œå¦‚æœä½ æƒ³ç”¨ VS 2022 çš„è¯ï¼Œå°±å¯ä»¥æŒ‡å®š vs2022_install ç¯å¢ƒå˜é‡ã€‚</li>
</ul>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># è¿™ä¸ª URL ç›®å‰ä¸éœ€è¦æŒ‚ä»£ç†ï¼Œéœ€è¦ä»£ç†å¯ä»¥æ”¹æˆ:</span>
<span class="c"># Invoke-WebRequest -URI `</span>
<span class="c">#   https://storage.googleapis.com/chrome-infra/depot_tools.zip `</span>
<span class="c">#   -Proxy "http://127.0.0.1:8001" -OutFile ./depot_tools.zip</span>
<span class="o">&gt;</span> Invoke-WebRequest <span class="nt">-URI</span> <span class="sb">`</span>
<span class="o">&gt;</span>   https://storage.googleapis.com/chrome-infra/depot_tools.zip <span class="sb">`</span>
<span class="o">&gt;</span>   <span class="nt">-OutFile</span> ./depot_tools.zip
<span class="c"># è§£å‹ï¼Œéœ€è¦å®‰è£…7zip</span>
<span class="o">&gt;</span> 7z x .<span class="se">\d</span>epot_tools.zip <span class="nt">-odepot_tools</span>
<span class="c"># æ£€æŸ¥.gitå­ç›®å½•å­˜åœ¨</span>
<span class="o">&gt;</span> <span class="nb">ls</span> .<span class="se">\d</span>epot_tools<span class="se">\.</span>git
<span class="o">&gt;</span> <span class="nb">cd</span> .<span class="se">\d</span>epot_tools<span class="se">\</span>
<span class="c"># ä¿®æ”¹ç¯å¢ƒå˜é‡, ä»…å½“å‰ä¼šè¯ç”Ÿæ•ˆ</span>
<span class="o">&gt;</span> <span class="nv">$env</span>:PATH<span class="o">=</span><span class="s2">"</span><span class="nv">$PWD</span><span class="s2">/;</span><span class="nv">$env</span><span class="s2">:PATH"</span>
<span class="o">&gt;</span> <span class="nv">$env</span>:DEPOT_TOOLS_WIN_TOOLCHAIN<span class="o">=</span>0
<span class="c"># $env:vs2019_install= `</span>
<span class="c">#   "C:\Program Files (x86)\Microsoft Visual Studio\2019\Community"</span>
</code></pre></div></div>

<h3 id="é…ç½®ä»£ç†">é…ç½®ä»£ç†</h3>

<p>depot_tools éœ€è¦æŒ‚ä»£ç†æ‰èƒ½æ­£å¸¸è¿è¡Œï¼Œå®ƒæ˜¯å¤šä¸ªå·¥å…·ã€è„šæœ¬çš„é›†åˆï¼Œä»£ç†è®¾ç½®ä¹Ÿéœ€è¦é…ç½®å¤šé¡¹ã€‚</p>

<h4 id="cipd">CIPD</h4>

<p>CIPD æ˜¯ä¸€ä¸ªåŒ…ç®¡ç†å·¥å…·ï¼Œdepot_tools ç”¨å®ƒæ¥ä¸‹è½½ä¾èµ–é¡¹ï¼Œå®ƒèƒ½å¤Ÿè¯»å–ç¯å¢ƒå˜é‡ä¸­çš„ä»£ç†è®¾ç½®ã€‚</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">&gt;</span> <span class="nv">$env</span>:HTTP_PRXOY<span class="o">=</span><span class="s1">'http://127.0.0.1:8001'</span>
<span class="o">&gt;</span> <span class="nv">$env</span>:HTTPS_PRXOY<span class="o">=</span><span class="s1">'http://127.0.0.1:8001'</span>
</code></pre></div></div>

<p>ç”¨å®Œåæ¸…é™¤ä»£ç†</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">&gt;</span> <span class="nv">$env</span>:HTTP_PRXOY<span class="o">=</span><span class="s1">''</span>
<span class="o">&gt;</span> <span class="nv">$env</span>:HTTPS_PROXY<span class="o">=</span><span class="s1">''</span>
</code></pre></div></div>
<h4 id="git">Git</h4>

<p>Git ä¹Ÿæ”¯æŒä»ç¯å¢ƒå˜é‡è¯»å–ä»£ç†é…ç½®ï¼Œæ— éœ€é¢å¤–é…ç½®ã€‚</p>

<p>å¦‚æœç¯å¢ƒå˜é‡ä¸ç”Ÿæ•ˆçš„è¯ï¼Œä¹Ÿå¯ä»¥ç”¨ä¸‹é¢çš„å‘½ä»¤æ˜¾ç¤ºç»™ Git æŒ‡å®šä»£ç†ã€‚</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">&gt;</span> git config <span class="nt">--global</span> http.proxy <span class="s2">"http://127.0.0.1:8001"</span>
<span class="o">&gt;</span> git config <span class="nt">--global</span> https.proxy <span class="s2">"http://127.0.0.1:8001"</span>
</code></pre></div></div>

<p>ç”¨å®Œåæ¸…é™¤ä»£ç†</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">&gt;</span> git config <span class="nt">--global</span> <span class="nt">--unset-all</span> http.proxy
<span class="o">&gt;</span> git config <span class="nt">--global</span> <span class="nt">--unset-all</span> https.proxy
</code></pre></div></div>

<p>è¿˜å¯ä»¥å‚è€ƒ https://gist.github.com/evantoli/f8c23a37eb3558ab8765 çš„åŠæ³•ï¼Œä»…å¯¹ googlesource.com è¿™ä¸ªåŸŸåè®¾ç½®ä»£ç†ï¼Œè¿™æ ·å°±å¯ä»¥ä¸€æ¬¡è®¾ç½®æ°¸ä¹…ä½¿ç”¨äº†ã€‚(åŸŸåå¯èƒ½å‘ç”Ÿå˜åŒ–ï¼Œä»¥ä½ çš„å®é™…æƒ…å†µä¸ºå‡†)</p>
<h4 id="gsutil">gsutil</h4>

<p>gsutil æ˜¯ Google äº‘å­˜å‚¨çš„å®¢æˆ·ç«¯ï¼Œè¢« depot_tools ç”¨æ¥ä¸‹è½½ä¾èµ–ï¼Œä¹Ÿéœ€è¦é¢å¤–é…ç½®ä»£ç†ã€‚</p>

<ul>
  <li>åˆ›å»ºå¦‚ä¸‹.botoæ–‡ä»¶
    <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>[Boto]
proxy = 127.0.0.1
proxy_port = 8001
proxy_type = http
</code></pre></div>    </div>
  </li>
  <li>è®¾ç½®ç¯å¢ƒå˜é‡ NO_AUTH_BOTO_CONFIGï¼Œä¸º .boto æ–‡ä»¶çš„å…¨è·¯å¾„
    <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">&gt;</span> <span class="nv">$env</span>:NO_AUTH_BOTO_CONFIG<span class="o">=</span><span class="s2">"</span><span class="nv">$PWD</span><span class="s2">/.boto"</span>
</code></pre></div>    </div>
  </li>
</ul>

<h3 id="åˆå§‹åŒ–">åˆå§‹åŒ–</h3>

<p>è®¾ç½®å¥½ä»£ç†åï¼Œç¬¬ä¸€æ¬¡è¿è¡Œ gclientï¼Œgclient ä¼šè‡ªåŠ¨å®‰è£…æ‰€éœ€çš„ä¾èµ–ã€‚å¦‚æœä»£ç†è®¾ç½®çš„éƒ½æ²¡æœ‰é—®é¢˜çš„è¯ï¼Œç¨ç­‰ä¸€ä¼šå°±ä¼šçœ‹åˆ° gclient è¾“å‡ºä½¿ç”¨å¸®åŠ©ã€‚</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">&gt;</span> gclient
WARNING: Your metrics.cfg file was invalid or nonexistent. A new one will be created.
Usage: gclient.py &lt;<span class="nb">command</span><span class="o">&gt;</span> <span class="o">[</span>options]

Meta checkout dependency manager <span class="k">for </span>Git.

Commands are:
  config   creates a .gclient file <span class="k">in </span>the current directory
  diff     displays <span class="nb">local </span>diff <span class="k">for </span>every dependencies
  fetch    fetches upstream commits <span class="k">for </span>all modules
  flatten  flattens the solutions into a single DEPS file
  getdep   gets revision information and variable values from a DEPS file
  <span class="nb">grep     </span>greps through git repos managed by gclient
  <span class="nb">help     </span>prints list of commands or <span class="nb">help </span><span class="k">for </span>a specific <span class="nb">command
  </span>metrics  reports, and optionally modifies, the status of metric collection
  pack     generates a patch which can be applied at the root of the tree
  recurse  operates <span class="o">[</span><span class="nb">command </span>args ...] on all the dependencies
  revert   reverts all modifications <span class="k">in </span>every dependencies
  revinfo  outputs revision info mapping <span class="k">for </span>the client and its dependencies
  root     outputs the solution root <span class="o">(</span>or current <span class="nb">dir </span><span class="k">if </span>there isn<span class="s1">'t one)
  runhooks runs hooks for files that have been modified in the local working copy
  setdep   modifies dependency revisions and variable values in a DEPS file
  status   shows modification status for every dependencies
  sync     checkout/update all modules
  validate validates the .gclient and DEPS syntax
  verify   verifies the DEPS file deps are only from allowed_hosts

Options:
  --version             show program'</span>s version number and <span class="nb">exit</span>
  <span class="nt">-h</span>, <span class="nt">--help</span>            show this <span class="nb">help </span>message and <span class="nb">exit</span>
  <span class="nt">-j</span> JOBS, <span class="nt">--jobs</span><span class="o">=</span>JOBS  Specify how many SCM commands can run <span class="k">in </span>parallel<span class="p">;</span>
                        defaults to 12 on this machine
  <span class="nt">-v</span>, <span class="nt">--verbose</span>         Produces additional output <span class="k">for </span>diagnostics. Can be
                        used up to three <span class="nb">times </span><span class="k">for </span>more logging info.
  <span class="nt">--gclientfile</span><span class="o">=</span>CONFIG_FILENAME
                        Specify an alternate .gclient file
  <span class="nt">--spec</span><span class="o">=</span>SPEC           create a gclient file containing the provided string.
                        Due to Cygwin/Python brokenness, it can<span class="s1">'t contain any
                        newlines.
  --no-nag-max          Ignored for backwards compatibility.
</span></code></pre></div></div>

<hr />

<p><strong>â„¹ï¸NOTE</strong></p>

<ul>
  <li>æ–‡æ¡£è¦æ±‚åœ¨ cmd.exe ä¸­æ„å»º Chromiumï¼Œä½†æˆ‘ä»‹ç»çš„éƒ½æ˜¯åœ¨ PWSH ä¸­è¿è¡Œçš„æ–¹æ³•ï¼Œæˆ‘ä½¿ç”¨çš„ PWSH ç‰ˆæœ¬å¦‚ä¸‹ï¼š
    <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">&gt;</span> <span class="nv">$PSVersionTable</span>
Name                           Value
<span class="nt">----</span>                           <span class="nt">-----</span>
PSVersion                      7.2.1
PSEdition                      Core
GitCommitId                    7.2.1
OS                             Microsoft Windows 10.0.19043
Platform                       Win32NT
PSCompatibleVersions           <span class="o">{</span>1.0, 2.0, 3.0, 4.0â€¦<span class="o">}</span>
PSRemotingProtocolVersion      2.3
SerializationVersion           1.1.0.1
WSManStackVersion              3.0
</code></pre></div>    </div>
  </li>
  <li>æ•´ä¸ªè¿‡ç¨‹ä¸­éœ€è¦èµ°ä»£ç†çš„æµé‡è¿˜æ˜¯å¾ˆå¤§çš„ï¼Œå¦‚æœä½ ä½¿ç”¨çš„æ˜¯æŒ‰æµé‡è®¡è´¹çš„ä»£ç†ï¼Œä»£ç†æä¾›å•†ä¸€èˆ¬æœ‰æä¾›ä¸è®°æµé‡çš„ä½é€ŸèŠ‚ç‚¹ã€‚</li>
  <li>é™„ä¸Š depot çš„<a href="https://youglish.com/pronounce/depot/english/us?">è¯»éŸ³</a></li>
</ul>

<hr />

<h2 id="ä¸‹è½½chromiumæºç ">ä¸‹è½½Chromiumæºç </h2>

<ul>
  <li>åœ¨ä»»æ„ä½ç½®ï¼Œæ–°å»º Chromium ç›®å½•ï¼Œä¾‹å¦‚ D:/Chromiumã€‚</li>
  <li>åˆ‡æ¢åˆ°æ–°åˆ›å»ºçš„ç›®å½•ï¼Œä½¿ç”¨ fetch å‘½ä»¤ä¸‹è½½ä»£ç ï¼Œç½‘ç»œä¸å¥½çš„è¯ï¼Œå¯ä»¥æŒ‡å®š --no-history å‘½ä»¤è¡Œï¼Œå¿½ç•¥ commit å†å²ï¼Œå‡å°äº†è¦ä¸‹è½½æ–‡ä»¶çš„ä½“ç§¯ï¼Œå‘½ä»¤æ‰§è¡ŒæˆåŠŸåä»£ç åœ¨ src å­ç›®å½•</li>
</ul>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">&gt;</span> <span class="nb">mkdir </span>chromium <span class="o">&amp;&amp;</span> <span class="nb">cd </span>chromium
<span class="o">&gt;</span> fetch <span class="nt">--no-history</span> chromium
</code></pre></div></div>

<p>çœ‹åˆ°ä»£ç æ‹‰å–æ­£å¸¸å¼€å§‹ä»¥åï¼Œå°±å¯ä»¥å»çœ‹ä¸€å­£ç”µè§†å‰§äº†ğŸ˜‚ã€‚ä¸çŸ¥é“æ˜¯ä¸æ˜¯æˆ‘çš„ä»£ç†ç½‘ç»œå¤ªæ…¢äº†ï¼Œæˆ‘ç”¨äº† 5 ä¸ªå°æ—¶å·¦å³æ‰å®Œæˆã€‚</p>

<h2 id="æ„å»º">æ„å»º</h2>

<ul>
  <li>ç¡®è®¤ç£ç›˜æœ‰è¶³å¤Ÿçš„ç©ºé—´ï¼Œæˆ‘è¿™é‡Œæ„å»ºå®Œæˆå out/Default ç›®å½•å ç”¨ 52 GiBï¼Œdepot_tools + chromium æ€»å…±å ç”¨ 74 GiB å·¦å³</li>
  <li><code class="language-plaintext highlighter-rouge">cd src</code> åˆ‡æ¢åˆ° src ç›®å½•</li>
  <li><code class="language-plaintext highlighter-rouge">gn args out/Default</code> ï¼Œåœ¨å¼¹å‡ºçš„è®°äº‹æœ¬ä¸­å¡«å…¥ä¸‹é¢çš„é…ç½®ï¼Œä¿å­˜åå…³é—­è®°äº‹æœ¬
    <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>is_component_build = true
enable_nacl = false
v8_optimized_debug = false
</code></pre></div>    </div>
  </li>
  <li>ç­‰å¾… GN æ‰§è¡Œï¼ŒGN ä¼šåœ¨ out/Default ç›®å½•ï¼Œç”Ÿæˆæ„å»ºæ‰€éœ€çš„æ–‡ä»¶</li>
  <li>(å¯é€‰) æŠŠ chromium ç›®å½•ï¼ŒåŠ å…¥åˆ°æ€æ¯’è½¯ä»¶çš„ç™½åå•ï¼Œé˜²æ­¢æ€æ¯’è½¯ä»¶åœ¨æ„å»ºè¿‡ç¨‹ä¸­ä¸æ–­æ‰«ææ„å»ºäº§ç‰©ï¼Œæ‹–æ…¢æ„å»ºé€Ÿåº¦</li>
  <li><code class="language-plaintext highlighter-rouge">autoninja -C out\Default chrome</code> ç”¨ ninja æ„å»º chromeï¼Œåˆéœ€è¦å‡ ä¸ªå°æ—¶ã€‚</li>
  <li>æ„å»ºæœŸé—´å·²ç»ä¸å†éœ€è¦ä»£ç†äº†ã€‚</li>
</ul>

<p>ç¼–è¯‘å®Œæˆåï¼Œå¯ä»¥åœ¨ out/Default ç›®å½•æ‰¾åˆ°ç¼–è¯‘å¥½çš„ chrome.exeã€‚</p>

<p>é»˜è®¤ç¼–è¯‘å‡ºæ¥çš„æ˜¯ Debug ç‰ˆï¼Œè¦ç¼–è¯‘ Release ç‰ˆçš„è¯ï¼Œé…ç½®æ”¹æˆï¼š</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>is_component_build = true
is_debug = false
enable_nacl = false
dcheck_always_on = true
</code></pre></div></div>

<p>Debug ç‰ˆå’Œ Release ç‰ˆå¯ä»¥åœ¨ä¸¤ä¸ªä¸åŒçš„ç›®å½•ä¸­å…±å­˜ï¼Œä¾‹å¦‚æŠŠä¸¤ä¸ªç‰ˆæœ¬åˆ†åˆ«æ”¾åˆ° out/Default å’Œ out/Releaseã€‚æ˜¯å¦å¯ä»¥åŒæ—¶ç¼–è¯‘ï¼Œè¿™ä¸ªæˆ‘è¿˜æ²¡è¯•è¿‡ï¼Œæœ‰éœ€æ±‚çš„è¯»è€…å¯ä»¥æµ‹è¯•ä¸€ä¸‹ã€‚</p>

<hr />

<p><strong>â„¹ï¸NOTE</strong></p>

<ul>
  <li>Chromium æ„å»ºç”¨åˆ°äº† GN å’Œ Ninja ä¸¤ä¸ªæ„å»ºå·¥å…·ã€‚<br />
GN å±äºå…ƒæ„å»ºå·¥å…·ï¼Œå®ƒå¹¶ä¸å®é™…æ‰§è¡Œæ„å»ºï¼Œè€Œæ˜¯è¾“å‡º Ninjaã€VS ç­‰å·¥å…·ä½¿ç”¨çš„æè¿°æ–‡ä»¶ï¼ŒGN çš„ä¼˜ç‚¹æ˜¯æè¿°æ–‡ä»¶é€‚åˆæ‰‹å·¥ç¼–å†™ã€‚ <br />
Ninja åˆ™ä¾§é‡ä¾›åº•å±‚æ„å»ºèƒ½åŠ›ï¼Œæå‡æ„å»ºé€Ÿåº¦ï¼Œä¸€èˆ¬é…åˆ GNã€CMake ä¹‹ç±»çš„å…ƒæ„å»ºå·¥å…·ä½¿ç”¨ã€‚</li>
  <li>GN ä»…éœ€è¿è¡Œä¸€æ¬¡ï¼Œä¹‹åä»…æ‰§è¡Œ Ninja å‘½ä»¤å³å¯ï¼ŒNinja ä¼šåœ¨å¿…è¦æ—¶è‡ªåŠ¨è°ƒç”¨ GNã€‚</li>
</ul>

<hr />

<h2 id="ç”Ÿæˆ-visual-studio-è§£å†³æ–¹æ¡ˆ-å¯é€‰">ç”Ÿæˆ Visual Studio è§£å†³æ–¹æ¡ˆ ï¼ˆå¯é€‰ï¼‰</h2>

<p>å¯ä»¥ç”¨ <code class="language-plaintext highlighter-rouge">gn gen --ide=vs</code> ç”ŸæˆåŒ…å«æ‰€æœ‰ä»£ç çš„ VS è§£å†³æ–¹æ¡ˆï¼Œä½†æ˜¯è¿™æ ·ç”Ÿæˆçš„è§£å†³æ–¹æ¡ˆå¤ªå¤§äº†ï¼Œä½¿ç”¨èµ·æ¥å¾ˆä¸æ–¹ä¾¿ï¼Œæ¨èç”¨ --filter å’Œ --no-deps å‘½ä»¤è¡Œé™å®šè§£å†³æ–¹æ¡ˆåŒ…å«çš„èŒƒå›´ã€‚</p>

<p>ä¾‹å¦‚ï¼šç”¨å¦‚ä¸‹å‘½ä»¤ç”ŸæˆåŒ…å« v8ã€base å’Œ blink çš„è§£å†³æ–¹æ¡ˆ out/Default/v8_blink.slnã€‚</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">&gt;</span> gn gen <span class="nt">--ide</span><span class="o">=</span>vs <span class="nt">--filters</span><span class="o">=</span><span class="s1">'//v8/*;//base/*;//third_party//blink/*'</span> <span class="sb">`</span>
  <span class="nt">--no-deps</span> <span class="nt">--sln</span><span class="o">=</span>blink_v8 out<span class="se">\D</span>efault
</code></pre></div></div>

<p>æ¨èé˜…è¯»<a href="https://gn.googlesource.com/gn/+/master/docs/reference.md#cmd_gen"> GN çš„å¸®åŠ©</a> å’Œ <a href="https://www.chromium.org/developers/how-tos/visualstudio-tricks/">VisualStudio Tricks</a> äº†è§£æ›´å¤šæŠ€å·§ã€‚</p>

  </div><div id="disqus_thread"></div>
  <script>
    var disqus_config = function () {
      this.page.url = '';
      this.page.identifier = 'https://pwntips.github.io/2022/03/20/build-chromium.html';
    };

    (function() {
      var d = document, s = d.createElement('script');

      s.src = 'https://PwnTips.disqus.com/embed.js';

      s.setAttribute('data-timestamp', +new Date());
      (d.head || d.body).appendChild(s);
    })();
  </script>
  <noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript" rel="nofollow">comments powered by Disqus.</a></noscript><a class="u-url" href="/2022/03/20/build-chromium.html" hidden></a>
</article>

      </div>
    </main><footer class="site-footer h-card">
  <data class="u-url" href="/"></data>

  <div class="wrapper">

    <div class="footer-col-wrapper">
      <div class="footer-col">
        <p class="feed-subscribe">
          <a href="https://pwntips.github.io/feed.xml">
            <svg class="svg-icon orange">
              <use xlink:href="/assets/minima-social-icons.svg#rss"></use>
            </svg><span>Subscribe</span>
          </a>
        </p>
      </div>
      <div class="footer-col">
        <p>Tips &amp; Tricks</p>
      </div>
    </div>

    <div class="social-links"><ul class="social-media-list"></ul>
</div>

  </div>

</footer>
</body>

</html>
